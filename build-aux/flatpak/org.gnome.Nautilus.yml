---
app-id: org.gnome.NautilusDevel
runtime: org.gnome.Platform
runtime-version: "master"
sdk: org.gnome.Sdk
command: nautilus
tags:
- devel
- development
- nightly
finish-args:
- "--share=ipc"
- "--socket=x11"
- "--socket=wayland"
- "--talk-name=org.gnome.OnlineAccounts"
- "--filesystem=host"
- "--talk-name=org.gtk.vfs"
- "--talk-name=org.gtk.vfs.*"
- "--filesystem=xdg-run/gvfsd"
- "--filesystem=xdg-run/dconf"
- "--filesystem=~/.config/dconf:ro"
- "--talk-name=ca.desrt.dconf"
- "--env=DCONF_USER_CONFIG_DIR=.config/dconf"
# Access to host Tracker Miners
- "--add-policy=Tracker3.dbus:org.freedesktop.Tracker3.Miner.Files=tracker:FileSystem;tracker:Documents"
modules:
- name: exiv2
  config-opts:
  - "-DCMAKE_INSTALL_PREFIX=/app"
  - "-DCMAKE_INSTALL_LIBDIR=/app/lib"
  buildsystem: cmake-ninja
  sources:
  - type: archive
    url: https://github.com/Exiv2/exiv2/archive/v0.26.tar.gz
    sha256: 51cffa8d19d67e1da6c1d0f570a75b8f6c814113367318c2c0407691888c5f01
- name: gexiv2
  buildsystem: meson
  builddir: true
  config-opts:
  - "--libdir=/app/lib"
  - "-Ddisable-introspection=True"
  sources:
  - type: git
    url: https://gitlab.gnome.org/GNOME/gexiv2.git
    tag: gexiv2-0.10.10
- name: tracker-miners
  buildsystem: meson
  cleanup:
  - "/etc"
  - "/libexec/tracker-3"
  - "/share/dbus-1/services/org.freedesktop.Tracker3.Miner.Extract.service"
  - "/share/dbus-1/services/org.freedesktop.Tracker3.Miner.Files.service"
  - "/share/dbus-1/services/org.freedesktop.Tracker3.Miner.Files.Control.service"
  config-opts:
  - "-Dextract=true"
  - "-Dgeneric_media_extractor=none"
  - "-Dman=false"
  - "-Dminer_fs=true"
  - "-Dminer_rss=false"
  - "-Dsystemd_user_services=false"
  - "-Dwriteback=false"
  sources:
  - type: git
    url: https://gitlab.gnome.org/GNOME/tracker-miners.git
    branch: master
- name: gnome-desktop
  buildsystem: meson
  config-opts:
  - "-Ddebug_tools=false"
  - "-Ddesktop_docs=false"
  - "-Dudev=disabled"
  sources:
  - type: git
    url: https://gitlab.gnome.org/GNOME/gnome-desktop.git
- name: gnome-autoar
  sources:
  - type: git
    url: https://gitlab.gnome.org/GNOME/gnome-autoar.git
- name: libportal
  buildsystem: meson
  builddir: true
  config-opts:
  - "--libdir=/app/lib"
  -  "--buildtype=debugoptimized"
  sources:
  - type: git
    url: https://github.com/flatpak/libportal.git
- buildsystem: meson
  builddir: true
  name: nautilus
  config-opts:
  - "--libdir=/app/lib"
  - "-Dprofile=Devel"
  - "-Dtests=all"
  sources:
  - type: git
    url: https://gitlab.gnome.org/GNOME/nautilus.git

